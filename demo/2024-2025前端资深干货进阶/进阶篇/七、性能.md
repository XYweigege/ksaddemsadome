### <font style="color:rgb(44, 62, 80);">1 DNS 预解析</font>
+ <font style="color:rgb(199, 37, 78);background-color:rgb(249, 242, 244);">DNS</font><font style="color:rgb(44, 62, 80);"> </font><font style="color:rgb(44, 62, 80);">解析也是需要时间的，可以通过预解析的方式来预先获得域名所对应的</font><font style="color:rgb(44, 62, 80);"> </font><font style="color:rgb(199, 37, 78);background-color:rgb(249, 242, 244);">IP</font>

```html
<link rel="dns-prefetch" href="//blog.poetries.top">
```

### [](https://www.123fe.net/docs/base/improve.html#_2-%E7%BC%93%E5%AD%98)<font style="color:rgb(44, 62, 80);">2 缓存</font>
+ <font style="color:rgb(44, 62, 80);">缓存对于前端性能优化来说是个很重要的点，良好的缓存策略可以降低资源的重复加载提高网页的整体加载速度</font>
+ <font style="color:rgb(44, 62, 80);">通常浏览器缓存策略分为两种：强缓存和协商缓存</font>

**<font style="color:rgb(44, 62, 80);">强缓存</font>**

<font style="color:rgb(85, 85, 85);background-color:rgb(255, 249, 249);">实现强缓存可以通过两种响应头实现：</font><font style="color:rgb(199, 37, 78);background-color:rgb(249, 242, 244);">Expires</font><font style="color:rgb(85, 85, 85);background-color:rgb(255, 249, 249);">和</font><font style="color:rgb(85, 85, 85);background-color:rgb(255, 249, 249);"> </font><font style="color:rgb(199, 37, 78);background-color:rgb(249, 242, 244);">Cache-Control</font><font style="color:rgb(85, 85, 85);background-color:rgb(255, 249, 249);"> </font><font style="color:rgb(85, 85, 85);background-color:rgb(255, 249, 249);">。强缓存表示在缓存期间不需要请求，</font><font style="color:rgb(199, 37, 78);background-color:rgb(249, 242, 244);">state code</font><font style="color:rgb(85, 85, 85);background-color:rgb(255, 249, 249);">为</font><font style="color:rgb(85, 85, 85);background-color:rgb(255, 249, 249);"> </font><font style="color:rgb(199, 37, 78);background-color:rgb(249, 242, 244);">200</font>

```plain
Expires: Wed, 22 Oct 2018 08:41:00 GMT
```

<font style="color:rgb(199, 37, 78);background-color:rgb(249, 242, 244);">Expires</font><font style="color:rgb(85, 85, 85);background-color:rgb(255, 249, 249);"> </font><font style="color:rgb(85, 85, 85);background-color:rgb(255, 249, 249);">是</font><font style="color:rgb(85, 85, 85);background-color:rgb(255, 249, 249);"> </font><font style="color:rgb(199, 37, 78);background-color:rgb(249, 242, 244);">HTTP / 1.0</font><font style="color:rgb(85, 85, 85);background-color:rgb(255, 249, 249);"> </font><font style="color:rgb(85, 85, 85);background-color:rgb(255, 249, 249);">的产物，表示资源会在</font><font style="color:rgb(85, 85, 85);background-color:rgb(255, 249, 249);"> </font><font style="color:rgb(199, 37, 78);background-color:rgb(249, 242, 244);">Wed, 22 Oct 2018 08:41:00 GMT</font><font style="color:rgb(85, 85, 85);background-color:rgb(255, 249, 249);"> </font><font style="color:rgb(85, 85, 85);background-color:rgb(255, 249, 249);">后过期，需要再次请求。并且</font><font style="color:rgb(85, 85, 85);background-color:rgb(255, 249, 249);"> </font><font style="color:rgb(199, 37, 78);background-color:rgb(249, 242, 244);">Expires</font><font style="color:rgb(85, 85, 85);background-color:rgb(255, 249, 249);"> </font><font style="color:rgb(85, 85, 85);background-color:rgb(255, 249, 249);">受限于本地时间，如果修改了本地时间，可能会造成缓存失效</font>

```plain
Cache-control: max-age=30
```

<font style="color:rgb(199, 37, 78);background-color:rgb(249, 242, 244);">Cache-Control</font><font style="color:rgb(85, 85, 85);background-color:rgb(255, 249, 249);"> </font><font style="color:rgb(85, 85, 85);background-color:rgb(255, 249, 249);">出现于</font><font style="color:rgb(85, 85, 85);background-color:rgb(255, 249, 249);"> </font><font style="color:rgb(199, 37, 78);background-color:rgb(249, 242, 244);">HTTP / 1.1</font><font style="color:rgb(85, 85, 85);background-color:rgb(255, 249, 249);">，优先级高于</font><font style="color:rgb(85, 85, 85);background-color:rgb(255, 249, 249);"> </font><font style="color:rgb(199, 37, 78);background-color:rgb(249, 242, 244);">Expires</font><font style="color:rgb(85, 85, 85);background-color:rgb(255, 249, 249);"> </font><font style="color:rgb(85, 85, 85);background-color:rgb(255, 249, 249);">。该属性表示资源会在</font><font style="color:rgb(85, 85, 85);background-color:rgb(255, 249, 249);"> </font><font style="color:rgb(199, 37, 78);background-color:rgb(249, 242, 244);">30</font><font style="color:rgb(85, 85, 85);background-color:rgb(255, 249, 249);"> </font><font style="color:rgb(85, 85, 85);background-color:rgb(255, 249, 249);">秒后过期，需要再次请求</font>

**<font style="color:rgb(44, 62, 80);">协商缓存</font>**

+ <font style="color:rgb(44, 62, 80);">如果缓存过期了，我们就可以使用协商缓存来解决问题。协商缓存需要请求，如果缓存有效会返回 304</font>
+ <font style="color:rgb(44, 62, 80);">协商缓存需要客户端和服务端共同实现，和强缓存一样，也有两种实现方式</font>

<font style="color:rgb(199, 37, 78);background-color:rgb(249, 242, 244);">Last-Modified</font><font style="color:rgb(44, 62, 80);"> </font><font style="color:rgb(44, 62, 80);">和</font><font style="color:rgb(44, 62, 80);"> </font><font style="color:rgb(199, 37, 78);background-color:rgb(249, 242, 244);">If-Modified-Since</font>

+ <font style="color:rgb(199, 37, 78);background-color:rgb(249, 242, 244);">Last-Modified</font><font style="color:rgb(44, 62, 80);"> </font><font style="color:rgb(44, 62, 80);">表示本地文件最后修改日期，</font><font style="color:rgb(199, 37, 78);background-color:rgb(249, 242, 244);">If-Modified-Since</font><font style="color:rgb(44, 62, 80);"> </font><font style="color:rgb(44, 62, 80);">会将</font><font style="color:rgb(44, 62, 80);"> </font><font style="color:rgb(199, 37, 78);background-color:rgb(249, 242, 244);">Last-Modified</font><font style="color:rgb(44, 62, 80);">的值发送给服务器，询问服务器在该日期后资源是否有更新，有更新的话就会将新的资源发送回来</font>
+ <font style="color:rgb(44, 62, 80);">但是如果在本地打开缓存文件，就会造成</font><font style="color:rgb(44, 62, 80);"> </font><font style="color:rgb(199, 37, 78);background-color:rgb(249, 242, 244);">Last-Modified</font><font style="color:rgb(44, 62, 80);"> </font><font style="color:rgb(44, 62, 80);">被修改，所以在</font><font style="color:rgb(44, 62, 80);"> </font><font style="color:rgb(199, 37, 78);background-color:rgb(249, 242, 244);">HTTP / 1.1</font><font style="color:rgb(44, 62, 80);"> </font><font style="color:rgb(44, 62, 80);">出现了</font><font style="color:rgb(44, 62, 80);"> </font><font style="color:rgb(199, 37, 78);background-color:rgb(249, 242, 244);">ETag</font>

<font style="color:rgb(199, 37, 78);background-color:rgb(249, 242, 244);">ETag</font><font style="color:rgb(44, 62, 80);"> </font><font style="color:rgb(44, 62, 80);">和</font><font style="color:rgb(44, 62, 80);"> </font><font style="color:rgb(199, 37, 78);background-color:rgb(249, 242, 244);">If-None-Match</font>

+ <font style="color:rgb(199, 37, 78);background-color:rgb(249, 242, 244);">ETag</font><font style="color:rgb(44, 62, 80);"> </font><font style="color:rgb(44, 62, 80);">类似于文件指纹，</font><font style="color:rgb(199, 37, 78);background-color:rgb(249, 242, 244);">If-None-Match</font><font style="color:rgb(44, 62, 80);"> </font><font style="color:rgb(44, 62, 80);">会将当前</font><font style="color:rgb(44, 62, 80);"> </font><font style="color:rgb(199, 37, 78);background-color:rgb(249, 242, 244);">ETag</font><font style="color:rgb(44, 62, 80);"> </font><font style="color:rgb(44, 62, 80);">发送给服务器，询问该资源 ETag 是否变动，有变动的话就将新的资源发送回来。并且</font><font style="color:rgb(44, 62, 80);"> </font><font style="color:rgb(199, 37, 78);background-color:rgb(249, 242, 244);">ETag</font><font style="color:rgb(44, 62, 80);"> </font><font style="color:rgb(44, 62, 80);">优先级比</font><font style="color:rgb(44, 62, 80);"> </font><font style="color:rgb(199, 37, 78);background-color:rgb(249, 242, 244);">Last-Modified</font><font style="color:rgb(44, 62, 80);"> </font><font style="color:rgb(44, 62, 80);">高</font>

**<font style="color:rgb(44, 62, 80);">选择合适的缓存策略</font>**

<font style="color:rgb(85, 85, 85);background-color:rgb(255, 249, 249);">对于大部分的场景都可以使用强缓存配合协商缓存解决，但是在一些特殊的地方可能需要选择特殊的缓存策略</font>

+ <font style="color:rgb(44, 62, 80);">对于某些不需要缓存的资源，可以使用</font><font style="color:rgb(44, 62, 80);"> </font><font style="color:rgb(199, 37, 78);background-color:rgb(249, 242, 244);">Cache-control: no-store</font><font style="color:rgb(44, 62, 80);"> </font><font style="color:rgb(44, 62, 80);">，表示该资源不需要缓存</font>
+ <font style="color:rgb(44, 62, 80);">对于频繁变动的资源，可以使用</font><font style="color:rgb(44, 62, 80);"> </font><font style="color:rgb(199, 37, 78);background-color:rgb(249, 242, 244);">Cache-Control: no-cache</font><font style="color:rgb(44, 62, 80);"> </font><font style="color:rgb(44, 62, 80);">并配合</font><font style="color:rgb(44, 62, 80);"> </font><font style="color:rgb(199, 37, 78);background-color:rgb(249, 242, 244);">ETag</font><font style="color:rgb(44, 62, 80);"> </font><font style="color:rgb(44, 62, 80);">使用，表示该资源已被缓存，但是每次都会发送请求询问资源是否更新。</font>
+ <font style="color:rgb(44, 62, 80);">对于代码文件来说，通常使用</font><font style="color:rgb(44, 62, 80);"> </font><font style="color:rgb(199, 37, 78);background-color:rgb(249, 242, 244);">Cache-Control: max-age=31536000</font><font style="color:rgb(44, 62, 80);"> </font><font style="color:rgb(44, 62, 80);">并配合策略缓存使用，然后对文件进行指纹处理，一旦文件名变动就会立刻下载新的文件</font>

### [](https://www.123fe.net/docs/base/improve.html#_3-%E4%BD%BF%E7%94%A8-http-2-0)<font style="color:rgb(44, 62, 80);">3 使用 HTTP / 2.0</font>
+ <font style="color:rgb(44, 62, 80);">因为浏览器会有并发请求限制，在</font><font style="color:rgb(44, 62, 80);"> </font><font style="color:rgb(199, 37, 78);background-color:rgb(249, 242, 244);">HTTP / 1.1</font><font style="color:rgb(44, 62, 80);"> </font><font style="color:rgb(44, 62, 80);">时代，每个请求都需要建立和断开，消耗了好几个</font><font style="color:rgb(44, 62, 80);"> </font><font style="color:rgb(199, 37, 78);background-color:rgb(249, 242, 244);">RTT</font><font style="color:rgb(44, 62, 80);"> </font><font style="color:rgb(44, 62, 80);">时间，并且由于</font><font style="color:rgb(44, 62, 80);"> </font><font style="color:rgb(199, 37, 78);background-color:rgb(249, 242, 244);">TCP</font><font style="color:rgb(44, 62, 80);"> </font><font style="color:rgb(44, 62, 80);">慢启动的原因，加载体积大的文件会需要更多的时间</font>
+ <font style="color:rgb(44, 62, 80);">在</font><font style="color:rgb(44, 62, 80);"> </font><font style="color:rgb(199, 37, 78);background-color:rgb(249, 242, 244);">HTTP / 2.0</font><font style="color:rgb(44, 62, 80);"> </font><font style="color:rgb(44, 62, 80);">中引入了多路复用，能够让多个请求使用同一个</font><font style="color:rgb(44, 62, 80);"> </font><font style="color:rgb(199, 37, 78);background-color:rgb(249, 242, 244);">TCP</font><font style="color:rgb(44, 62, 80);"> </font><font style="color:rgb(44, 62, 80);">链接，极大的加快了网页的加载速度。并且还支持</font><font style="color:rgb(44, 62, 80);"> </font><font style="color:rgb(199, 37, 78);background-color:rgb(249, 242, 244);">Header</font><font style="color:rgb(44, 62, 80);"> </font><font style="color:rgb(44, 62, 80);">压缩，进一步的减少了请求的数据大小</font>

### [](https://www.123fe.net/docs/base/improve.html#_4-%E9%A2%84%E5%8A%A0%E8%BD%BD)<font style="color:rgb(44, 62, 80);">4 预加载</font>
+ <font style="color:rgb(44, 62, 80);">在开发中，可能会遇到这样的情况。有些资源不需要马上用到，但是希望尽早获取，这时候就可以使用预加载</font>
+ <font style="color:rgb(44, 62, 80);">预加载其实是声明式的</font><font style="color:rgb(44, 62, 80);"> </font><font style="color:rgb(199, 37, 78);background-color:rgb(249, 242, 244);">fetch</font><font style="color:rgb(44, 62, 80);"> </font><font style="color:rgb(44, 62, 80);">，强制浏览器请求资源，并且不会阻塞</font><font style="color:rgb(44, 62, 80);"> </font><font style="color:rgb(199, 37, 78);background-color:rgb(249, 242, 244);">onload</font><font style="color:rgb(44, 62, 80);"> </font><font style="color:rgb(44, 62, 80);">事件，可以使用以下代码开启预加载</font>

```html
<link rel="preload" href="http://example.com">
```

<font style="color:rgb(85, 85, 85);background-color:rgb(255, 249, 249);">预加载可以一定程度上降低首屏的加载时间，因为可以将一些不影响首屏但重要的文件延后加载，唯一缺点就是兼容性不好</font>

### [](https://www.123fe.net/docs/base/improve.html#_5-%E9%A2%84%E6%B8%B2%E6%9F%93)<font style="color:rgb(44, 62, 80);">5 预渲染</font>
<font style="color:rgb(85, 85, 85);background-color:rgb(255, 249, 249);">可以通过预渲染将下载的文件预先在后台渲染，可以使用以下代码开启预渲染</font>

```html
<link rel="prerender" href="http://poetries.com">
```

+ <font style="color:rgb(44, 62, 80);">预渲染虽然可以提高页面的加载速度，但是要确保该页面百分百会被用户在之后打开，否则就白白浪费资源去渲染</font>

**<font style="color:rgb(44, 62, 80);">总结</font>**

+ <font style="color:rgb(199, 37, 78);background-color:rgb(249, 242, 244);">defer</font><font style="color:rgb(44, 62, 80);"> </font><font style="color:rgb(44, 62, 80);">和</font><font style="color:rgb(44, 62, 80);"> </font><font style="color:rgb(199, 37, 78);background-color:rgb(249, 242, 244);">async</font><font style="color:rgb(44, 62, 80);">在网络读取的过程中都是异步解析</font>
+ <font style="color:rgb(199, 37, 78);background-color:rgb(249, 242, 244);">defer</font><font style="color:rgb(44, 62, 80);">是有顺序依赖的，</font><font style="color:rgb(199, 37, 78);background-color:rgb(249, 242, 244);">async</font><font style="color:rgb(44, 62, 80);">只要脚本加载完后就会执行</font>
+ <font style="color:rgb(199, 37, 78);background-color:rgb(249, 242, 244);">preload</font><font style="color:rgb(44, 62, 80);"> </font><font style="color:rgb(44, 62, 80);">可以对当前页面所需的脚本、样式等资源进行预加载</font>
+ <font style="color:rgb(199, 37, 78);background-color:rgb(249, 242, 244);">prefetch</font><font style="color:rgb(44, 62, 80);"> </font><font style="color:rgb(44, 62, 80);">加载的资源一般不是用于当前页面的，是未来很可能用到的这样一些资源</font>

### [](https://www.123fe.net/docs/base/improve.html#_6-%E6%87%92%E6%89%A7%E8%A1%8C%E4%B8%8E%E6%87%92%E5%8A%A0%E8%BD%BD)<font style="color:rgb(44, 62, 80);">6 懒执行与懒加载</font>
**<font style="color:rgb(44, 62, 80);">懒执行</font>**

+ <font style="color:rgb(44, 62, 80);">懒执行就是将某些逻辑延迟到使用时再计算。该技术可以用于首屏优化，对于某些耗时逻辑并不需要在首屏就使用的，就可以使用懒执行。懒执行需要唤醒，一般可以通过定时器或者事件的调用来唤醒</font>

**<font style="color:rgb(44, 62, 80);">懒加载</font>**

+ <font style="color:rgb(44, 62, 80);">懒加载就是将不关键的资源延后加载</font>

<font style="color:rgb(85, 85, 85);background-color:rgb(255, 249, 249);">懒加载的原理就是只加载自定义区域（通常是可视区域，但也可以是即将进入可视区域）内需要加载的东西。对于图片来说，先设置图片标签的</font><font style="color:rgb(85, 85, 85);background-color:rgb(255, 249, 249);"> </font><font style="color:rgb(199, 37, 78);background-color:rgb(249, 242, 244);">src</font><font style="color:rgb(85, 85, 85);background-color:rgb(255, 249, 249);"> </font><font style="color:rgb(85, 85, 85);background-color:rgb(255, 249, 249);">属性为一张占位图，将真实的图片资源放入一个自定义属性中，当进入自定义区域时，就将自定义属性替换为</font><font style="color:rgb(85, 85, 85);background-color:rgb(255, 249, 249);"> </font><font style="color:rgb(199, 37, 78);background-color:rgb(249, 242, 244);">src</font><font style="color:rgb(85, 85, 85);background-color:rgb(255, 249, 249);"> </font><font style="color:rgb(85, 85, 85);background-color:rgb(255, 249, 249);">属性，这样图片就会去下载资源，实现了图片懒加载</font>

+ <font style="color:rgb(44, 62, 80);">懒加载不仅可以用于图片，也可以使用在别的资源上。比如进入可视区域才开始播放视频等</font>

### [](https://www.123fe.net/docs/base/improve.html#_7-%E6%96%87%E4%BB%B6%E4%BC%98%E5%8C%96)<font style="color:rgb(44, 62, 80);">7 文件优化</font>
**<font style="color:rgb(44, 62, 80);">图片优化</font>**

<font style="color:rgb(85, 85, 85);background-color:rgb(255, 249, 249);">对于如何优化图片，有 2 个思路</font>

+ <font style="color:rgb(44, 62, 80);">减少像素点</font>
+ <font style="color:rgb(44, 62, 80);">减少每个像素点能够显示的颜色</font>

**<font style="color:rgb(44, 62, 80);">图片加载优化</font>**

+ <font style="color:rgb(44, 62, 80);">不用图片。很多时候会使用到很多修饰类图片，其实这类修饰图片完全可以用</font><font style="color:rgb(44, 62, 80);"> </font><font style="color:rgb(199, 37, 78);background-color:rgb(249, 242, 244);">CSS</font><font style="color:rgb(44, 62, 80);"> </font><font style="color:rgb(44, 62, 80);">去代替。</font>
+ <font style="color:rgb(44, 62, 80);">对于移动端来说，屏幕宽度就那么点，完全没有必要去加载原图浪费带宽。一般图片都用 CDN 加载，可以计算出适配屏幕的宽度，然后去请求相应裁剪好的图片</font>
+ <font style="color:rgb(44, 62, 80);">小图使用</font><font style="color:rgb(44, 62, 80);"> </font><font style="color:rgb(199, 37, 78);background-color:rgb(249, 242, 244);">base64</font><font style="color:rgb(44, 62, 80);">格式</font>
+ <font style="color:rgb(44, 62, 80);">将多个图标文件整合到一张图片中（雪碧图）</font>
+ <font style="color:rgb(44, 62, 80);">选择正确的图片格式：</font>
    - <font style="color:rgb(44, 62, 80);">对于能够显示</font><font style="color:rgb(44, 62, 80);"> </font><font style="color:rgb(199, 37, 78);background-color:rgb(249, 242, 244);">WebP</font><font style="color:rgb(44, 62, 80);"> </font><font style="color:rgb(44, 62, 80);">格式的浏览器尽量使用</font><font style="color:rgb(44, 62, 80);"> </font><font style="color:rgb(199, 37, 78);background-color:rgb(249, 242, 244);">WebP</font><font style="color:rgb(44, 62, 80);"> </font><font style="color:rgb(44, 62, 80);">格式。因为</font><font style="color:rgb(44, 62, 80);"> </font><font style="color:rgb(199, 37, 78);background-color:rgb(249, 242, 244);">WebP</font><font style="color:rgb(44, 62, 80);"> </font><font style="color:rgb(44, 62, 80);">格式具有更好的图像数据压缩算法，能带来更小的图片体积，而且拥有肉眼识别无差异的图像质量，缺点就是兼容性并不好</font>
    - <font style="color:rgb(44, 62, 80);">小图使用</font><font style="color:rgb(44, 62, 80);"> </font><font style="color:rgb(199, 37, 78);background-color:rgb(249, 242, 244);">PNG</font><font style="color:rgb(44, 62, 80);">，其实对于大部分图标这类图片，完全可以使用</font><font style="color:rgb(44, 62, 80);"> </font><font style="color:rgb(199, 37, 78);background-color:rgb(249, 242, 244);">SVG</font><font style="color:rgb(44, 62, 80);"> </font><font style="color:rgb(44, 62, 80);">代替</font>
    - <font style="color:rgb(44, 62, 80);">照片使用</font><font style="color:rgb(44, 62, 80);"> </font><font style="color:rgb(199, 37, 78);background-color:rgb(249, 242, 244);">JPEG</font>

**<font style="color:rgb(44, 62, 80);">其他文件优化</font>**

+ <font style="color:rgb(199, 37, 78);background-color:rgb(249, 242, 244);">CSS</font><font style="color:rgb(44, 62, 80);">文件放在</font><font style="color:rgb(44, 62, 80);"> </font><font style="color:rgb(199, 37, 78);background-color:rgb(249, 242, 244);">head</font><font style="color:rgb(44, 62, 80);"> </font><font style="color:rgb(44, 62, 80);">中</font>
+ <font style="color:rgb(44, 62, 80);">服务端开启文件压缩功能</font>
+ <font style="color:rgb(44, 62, 80);">将</font><font style="color:rgb(44, 62, 80);"> </font><font style="color:rgb(199, 37, 78);background-color:rgb(249, 242, 244);">script</font><font style="color:rgb(44, 62, 80);"> </font><font style="color:rgb(44, 62, 80);">标签放在</font><font style="color:rgb(44, 62, 80);"> </font><font style="color:rgb(199, 37, 78);background-color:rgb(249, 242, 244);">body</font><font style="color:rgb(44, 62, 80);"> </font><font style="color:rgb(44, 62, 80);">底部，因为</font><font style="color:rgb(44, 62, 80);"> </font><font style="color:rgb(199, 37, 78);background-color:rgb(249, 242, 244);">JS</font><font style="color:rgb(44, 62, 80);"> </font><font style="color:rgb(44, 62, 80);">文件执行会阻塞渲染。当然也可以把</font><font style="color:rgb(44, 62, 80);"> </font><font style="color:rgb(199, 37, 78);background-color:rgb(249, 242, 244);">script</font><font style="color:rgb(44, 62, 80);"> </font><font style="color:rgb(44, 62, 80);">标签放在任意位置然后加上</font><font style="color:rgb(44, 62, 80);"> </font><font style="color:rgb(199, 37, 78);background-color:rgb(249, 242, 244);">defer</font><font style="color:rgb(44, 62, 80);"> </font><font style="color:rgb(44, 62, 80);">，表示该文件会并行下载，但是会放到</font><font style="color:rgb(44, 62, 80);"> </font><font style="color:rgb(199, 37, 78);background-color:rgb(249, 242, 244);">HTML</font><font style="color:rgb(44, 62, 80);"> </font><font style="color:rgb(44, 62, 80);">解析完成后顺序执行。对于没有任何依赖的</font><font style="color:rgb(44, 62, 80);"> </font><font style="color:rgb(199, 37, 78);background-color:rgb(249, 242, 244);">JS</font><font style="color:rgb(44, 62, 80);">文件可以加上</font><font style="color:rgb(44, 62, 80);"> </font><font style="color:rgb(199, 37, 78);background-color:rgb(249, 242, 244);">async</font><font style="color:rgb(44, 62, 80);"> </font><font style="color:rgb(44, 62, 80);">，表示加载和渲染后续文档元素的过程将和</font><font style="color:rgb(44, 62, 80);"> </font><font style="color:rgb(199, 37, 78);background-color:rgb(249, 242, 244);">JS</font><font style="color:rgb(44, 62, 80);"> </font><font style="color:rgb(44, 62, 80);">文件的加载与执行并行无序进行。 执行</font><font style="color:rgb(44, 62, 80);"> </font><font style="color:rgb(199, 37, 78);background-color:rgb(249, 242, 244);">JS</font><font style="color:rgb(44, 62, 80);">代码过长会卡住渲染，对于需要很多时间计算的代码</font>
+ <font style="color:rgb(44, 62, 80);">可以考虑使用</font><font style="color:rgb(44, 62, 80);"> </font><font style="color:rgb(199, 37, 78);background-color:rgb(249, 242, 244);">Webworker</font><font style="color:rgb(44, 62, 80);">。</font><font style="color:rgb(199, 37, 78);background-color:rgb(249, 242, 244);">Webworker</font><font style="color:rgb(44, 62, 80);">可以让我们另开一个线程执行脚本而不影响渲染。</font>

**<font style="color:rgb(44, 62, 80);">CDN</font>**

<font style="color:rgb(85, 85, 85);background-color:rgb(255, 249, 249);">静态资源尽量使用</font><font style="color:rgb(85, 85, 85);background-color:rgb(255, 249, 249);"> </font><font style="color:rgb(199, 37, 78);background-color:rgb(249, 242, 244);">CDN</font><font style="color:rgb(85, 85, 85);background-color:rgb(255, 249, 249);"> </font><font style="color:rgb(85, 85, 85);background-color:rgb(255, 249, 249);">加载，由于浏览器对于单个域名有并发请求上限，可以考虑使用多个</font><font style="color:rgb(85, 85, 85);background-color:rgb(255, 249, 249);"> </font><font style="color:rgb(199, 37, 78);background-color:rgb(249, 242, 244);">CDN</font><font style="color:rgb(85, 85, 85);background-color:rgb(255, 249, 249);"> </font><font style="color:rgb(85, 85, 85);background-color:rgb(255, 249, 249);">域名。对于</font><font style="color:rgb(85, 85, 85);background-color:rgb(255, 249, 249);"> </font><font style="color:rgb(199, 37, 78);background-color:rgb(249, 242, 244);">CDN</font><font style="color:rgb(85, 85, 85);background-color:rgb(255, 249, 249);"> </font><font style="color:rgb(85, 85, 85);background-color:rgb(255, 249, 249);">加载静态资源需要注意</font><font style="color:rgb(85, 85, 85);background-color:rgb(255, 249, 249);"> </font><font style="color:rgb(199, 37, 78);background-color:rgb(249, 242, 244);">CDN</font><font style="color:rgb(85, 85, 85);background-color:rgb(255, 249, 249);"> </font><font style="color:rgb(85, 85, 85);background-color:rgb(255, 249, 249);">域名要与主站不同，否则每次请求都会带上主站的</font><font style="color:rgb(85, 85, 85);background-color:rgb(255, 249, 249);"> </font><font style="color:rgb(199, 37, 78);background-color:rgb(249, 242, 244);">Cookie</font>

### [](https://www.123fe.net/docs/base/improve.html#_8-%E5%85%B6%E4%BB%96)<font style="color:rgb(44, 62, 80);">8 其他</font>
**<font style="color:rgb(44, 62, 80);">使用 Webpack 优化项目</font>**

+ <font style="color:rgb(44, 62, 80);">对于</font><font style="color:rgb(44, 62, 80);"> </font><font style="color:rgb(199, 37, 78);background-color:rgb(249, 242, 244);">Webpack4</font><font style="color:rgb(44, 62, 80);">，打包项目使用</font><font style="color:rgb(44, 62, 80);"> </font><font style="color:rgb(199, 37, 78);background-color:rgb(249, 242, 244);">production</font><font style="color:rgb(44, 62, 80);"> </font><font style="color:rgb(44, 62, 80);">模式，这样会自动开启代码压缩</font>
+ <font style="color:rgb(44, 62, 80);">使用</font><font style="color:rgb(44, 62, 80);"> </font><font style="color:rgb(199, 37, 78);background-color:rgb(249, 242, 244);">ES6</font><font style="color:rgb(44, 62, 80);"> </font><font style="color:rgb(44, 62, 80);">模块来开启</font><font style="color:rgb(44, 62, 80);"> </font><font style="color:rgb(199, 37, 78);background-color:rgb(249, 242, 244);">tree shaking</font><font style="color:rgb(44, 62, 80);">，这个技术可以移除没有使用的代码</font>
+ <font style="color:rgb(44, 62, 80);">优化图片，对于小图可以使用</font><font style="color:rgb(44, 62, 80);"> </font><font style="color:rgb(199, 37, 78);background-color:rgb(249, 242, 244);">base64</font><font style="color:rgb(44, 62, 80);"> </font><font style="color:rgb(44, 62, 80);">的方式写入文件中</font>
+ <font style="color:rgb(44, 62, 80);">按照路由拆分代码，实现按需加载</font>
+ <font style="color:rgb(44, 62, 80);">给打包出来的文件名添加哈希，实现浏览器缓存文件</font>

**<font style="color:rgb(44, 62, 80);">监控</font>**

<font style="color:rgb(85, 85, 85);background-color:rgb(255, 249, 249);">对于代码运行错误，通常的办法是使用</font><font style="color:rgb(85, 85, 85);background-color:rgb(255, 249, 249);"> </font><font style="color:rgb(199, 37, 78);background-color:rgb(249, 242, 244);">window.onerror</font><font style="color:rgb(85, 85, 85);background-color:rgb(255, 249, 249);"> </font><font style="color:rgb(85, 85, 85);background-color:rgb(255, 249, 249);">拦截报错。该方法能拦截到大部分的详细报错信息，但是也有例外</font>

+ <font style="color:rgb(44, 62, 80);">对于跨域的代码运行错误会显示</font><font style="color:rgb(44, 62, 80);"> </font><font style="color:rgb(199, 37, 78);background-color:rgb(249, 242, 244);">Script error</font><font style="color:rgb(44, 62, 80);">. 对于这种情况我们需要给</font><font style="color:rgb(44, 62, 80);"> </font><font style="color:rgb(199, 37, 78);background-color:rgb(249, 242, 244);">script</font><font style="color:rgb(44, 62, 80);"> </font><font style="color:rgb(44, 62, 80);">标签添加</font><font style="color:rgb(44, 62, 80);"> </font><font style="color:rgb(199, 37, 78);background-color:rgb(249, 242, 244);">crossorigin</font><font style="color:rgb(44, 62, 80);"> </font><font style="color:rgb(44, 62, 80);">属性</font>
+ <font style="color:rgb(44, 62, 80);">对于某些浏览器可能不会显示调用栈信息，这种情况可以通过</font><font style="color:rgb(44, 62, 80);"> </font><font style="color:rgb(199, 37, 78);background-color:rgb(249, 242, 244);">arguments.callee.caller</font><font style="color:rgb(44, 62, 80);"> </font><font style="color:rgb(44, 62, 80);">来做栈递归</font>
+ <font style="color:rgb(44, 62, 80);">对于异步代码来说，可以使用</font><font style="color:rgb(44, 62, 80);"> </font><font style="color:rgb(199, 37, 78);background-color:rgb(249, 242, 244);">catch</font><font style="color:rgb(44, 62, 80);"> </font><font style="color:rgb(44, 62, 80);">的方式捕获错误。比如</font><font style="color:rgb(44, 62, 80);"> </font><font style="color:rgb(199, 37, 78);background-color:rgb(249, 242, 244);">Promise</font><font style="color:rgb(44, 62, 80);"> </font><font style="color:rgb(44, 62, 80);">可以直接使用 catch 函数，</font><font style="color:rgb(199, 37, 78);background-color:rgb(249, 242, 244);">async await</font><font style="color:rgb(44, 62, 80);"> </font><font style="color:rgb(44, 62, 80);">可以使用</font><font style="color:rgb(44, 62, 80);"> </font><font style="color:rgb(199, 37, 78);background-color:rgb(249, 242, 244);">try catch</font>
+ <font style="color:rgb(44, 62, 80);">但是要注意线上运行的代码都是压缩过的，需要在打包时生成</font><font style="color:rgb(44, 62, 80);"> </font><font style="color:rgb(199, 37, 78);background-color:rgb(249, 242, 244);">sourceMap</font><font style="color:rgb(44, 62, 80);"> </font><font style="color:rgb(44, 62, 80);">文件便于</font><font style="color:rgb(44, 62, 80);"> </font><font style="color:rgb(199, 37, 78);background-color:rgb(249, 242, 244);">debug</font><font style="color:rgb(44, 62, 80);">。</font>
+ <font style="color:rgb(44, 62, 80);">对于捕获的错误需要上传给服务器，通常可以通过</font><font style="color:rgb(44, 62, 80);"> </font><font style="color:rgb(199, 37, 78);background-color:rgb(249, 242, 244);">img</font><font style="color:rgb(44, 62, 80);"> </font><font style="color:rgb(44, 62, 80);">标签的</font><font style="color:rgb(44, 62, 80);"> </font><font style="color:rgb(199, 37, 78);background-color:rgb(249, 242, 244);">src</font><font style="color:rgb(44, 62, 80);">发起一个请求</font>

### [](https://www.123fe.net/docs/base/improve.html#_9-%E5%A6%82%E4%BD%95%E6%A0%B9%E6%8D%AEchrome%E7%9A%84timing%E4%BC%98%E5%8C%96)<font style="color:rgb(44, 62, 80);">9 如何根据chrome的timing优化</font>
**<font style="color:rgb(44, 62, 80);">性能优化API</font>**

+ <font style="color:rgb(199, 37, 78);background-color:rgb(249, 242, 244);">Performance</font><font style="color:rgb(44, 62, 80);">。</font><font style="color:rgb(199, 37, 78);background-color:rgb(249, 242, 244);">performance.now()</font><font style="color:rgb(44, 62, 80);">与</font><font style="color:rgb(199, 37, 78);background-color:rgb(249, 242, 244);">new Date()</font><font style="color:rgb(44, 62, 80);">区别，它是高精度的，且是相对时间，相对于页面加载的那一刻。但是不一定适合单页面场景</font>
+ <font style="color:rgb(199, 37, 78);background-color:rgb(249, 242, 244);">window.addEventListener("load", "");</font><font style="color:rgb(44, 62, 80);"> </font><font style="color:rgb(199, 37, 78);background-color:rgb(249, 242, 244);">window.addEventListener("domContentLoaded", "");</font>
+ <font style="color:rgb(199, 37, 78);background-color:rgb(249, 242, 244);">Img</font><font style="color:rgb(44, 62, 80);">的</font><font style="color:rgb(199, 37, 78);background-color:rgb(249, 242, 244);">onload</font><font style="color:rgb(44, 62, 80);">事件，监听首屏内的图片是否加载完成，判断首屏事件</font>
+ <font style="color:rgb(199, 37, 78);background-color:rgb(249, 242, 244);">RequestFrameAnmation</font><font style="color:rgb(44, 62, 80);"> </font><font style="color:rgb(44, 62, 80);">和</font><font style="color:rgb(44, 62, 80);"> </font><font style="color:rgb(199, 37, 78);background-color:rgb(249, 242, 244);">RequestIdleCallback</font>
+ <font style="color:rgb(199, 37, 78);background-color:rgb(249, 242, 244);">IntersectionObserver</font><font style="color:rgb(44, 62, 80);">、</font><font style="color:rgb(199, 37, 78);background-color:rgb(249, 242, 244);">MutationObserver</font><font style="color:rgb(44, 62, 80);">，</font><font style="color:rgb(199, 37, 78);background-color:rgb(249, 242, 244);">PostMessage</font>
+ <font style="color:rgb(199, 37, 78);background-color:rgb(249, 242, 244);">Web Worker</font><font style="color:rgb(44, 62, 80);">，耗时任务放在里面执行</font>

**<font style="color:rgb(44, 62, 80);">检测工具</font>**

+ <font style="color:rgb(199, 37, 78);background-color:rgb(249, 242, 244);">Chrome Dev Tools</font>
+ <font style="color:rgb(199, 37, 78);background-color:rgb(249, 242, 244);">Page Speed</font>
+ <font style="color:rgb(199, 37, 78);background-color:rgb(249, 242, 244);">Jspref</font>

**<font style="color:rgb(44, 62, 80);">前端指标</font>**

![](https://cdn.nlark.com/yuque/0/2024/png/207857/1718782249235-3bc34212-1461-4187-a35e-7c66186e72d0.png)

```javascript
window.onload = function(){
  setTimeout(function(){
    let t = performance.timing
    console.log('DNS查询耗时 ：' + (t.domainLookupEnd - t.domainLookupStart).toFixed(0))
    console.log('TCP链接耗时 ：' + (t.connectEnd - t.connectStart).toFixed(0))
    console.log('request请求耗时 ：' + (t.responseEnd - t.responseStart).toFixed(0))
    console.log('解析dom树耗时 ：' + (t.domComplete - t.domInteractive).toFixed(0))
    console.log('白屏时间 ：' + (t.responseStart - t.navigationStart).toFixed(0))
    console.log('domready时间 ：' + (t.domContentLoadedEventEnd - t.navigationStart).toFixed(0))
    console.log('onload时间 ：' + (t.loadEventEnd - t.navigationStart).toFixed(0))

    if(t = performance.memory){
      console.log('js内存使用占比 ：' + (t.usedJSHeapSize / t.totalJSHeapSize * 100).toFixed(2) + '%')
    }
  })
}
```

**<font style="color:rgb(44, 62, 80);">DNS预解析优化</font>**

<font style="color:rgb(85, 85, 85);background-color:rgb(255, 249, 249);">dns解析是很耗时的，因此如果解析域名过多，会让首屏加载变得过慢，可以考虑dns-prefetch优化</font>

<font style="color:rgb(199, 37, 78);background-color:rgb(249, 242, 244);">DNS Prefetch</font><font style="color:rgb(44, 62, 80);"> </font><font style="color:rgb(44, 62, 80);">应该尽量的放在网页的前面，推荐放在 后面。具体使用方法如下：</font>

```html
<meta http-equiv="x-dns-prefetch-control" content="on">
<link rel="dns-prefetch" href="//www.zhix.net">
<link rel="dns-prefetch" href="//api.share.zhix.net">
<link rel="dns-prefetch" href="//bdimg.share.zhix.net">
```

**<font style="color:rgb(44, 62, 80);">request请求耗时</font>**

+ <font style="color:rgb(44, 62, 80);">不请求，用cache（最好的方式就是尽量引用公共资源，同时设置缓存，不去重新请求资源，也可以运用PWA的离线缓存技术，可以帮助wep实现离线使用）</font>
+ <font style="color:rgb(44, 62, 80);">前端打包时压缩</font>
+ <font style="color:rgb(44, 62, 80);">服务器上的zip压缩</font>
+ <font style="color:rgb(44, 62, 80);">图片压缩（比如tiny），使用webp等高压缩比格式</font>
+ <font style="color:rgb(44, 62, 80);">把过大的包，拆分成多个较少的包，防止单个资源耗时过大</font>
+ <font style="color:rgb(44, 62, 80);">同一时间针对同一域名下的请求有一定数量限制，超过限制数目的请求会被阻塞。如果资源来自于多个域下，可以增大并行请求和下载速度</font>
+ <font style="color:rgb(44, 62, 80);">延迟、异步、预加载、懒加载</font>
+ <font style="color:rgb(44, 62, 80);">对于非首屏的资源，可以使用 defer 或 async 的方式引入</font>
+ <font style="color:rgb(44, 62, 80);">也可以按需加载，在逻辑中，只有执行到时才做请求</font>
+ <font style="color:rgb(44, 62, 80);">对于多屏页面，滚动时才动态载入图片</font>

### [](https://www.123fe.net/docs/base/improve.html#_10-%E7%A7%BB%E5%8A%A8%E7%AB%AF%E4%BC%98%E5%8C%96)<font style="color:rgb(44, 62, 80);">10 移动端优化</font>
![](https://cdn.nlark.com/yuque/0/2024/png/207857/1718782249235-074ee5fc-9003-4106-8338-031939d37c7a.png)

**<font style="color:rgb(44, 62, 80);">1. 概述</font>**

+ <font style="color:rgb(199, 37, 78);background-color:rgb(249, 242, 244);">PC</font><font style="color:rgb(44, 62, 80);">优化手段在</font><font style="color:rgb(199, 37, 78);background-color:rgb(249, 242, 244);">Mobile</font><font style="color:rgb(44, 62, 80);">侧同样适用</font>
+ <font style="color:rgb(44, 62, 80);">在</font><font style="color:rgb(199, 37, 78);background-color:rgb(249, 242, 244);">Mobile</font><font style="color:rgb(44, 62, 80);">侧我们提出三秒种渲染完成首屏指标</font>
+ <font style="color:rgb(44, 62, 80);">基于第二点，首屏加载</font><font style="color:rgb(199, 37, 78);background-color:rgb(249, 242, 244);">3</font><font style="color:rgb(44, 62, 80);">秒完成或使用</font><font style="color:rgb(199, 37, 78);background-color:rgb(249, 242, 244);">Loading</font>
+ <font style="color:rgb(44, 62, 80);">基于联通3G网络平均</font><font style="color:rgb(199, 37, 78);background-color:rgb(249, 242, 244);">338KB/s(2.71Mb/s</font><font style="color:rgb(44, 62, 80);">），所以首屏资源不应超过</font><font style="color:rgb(199, 37, 78);background-color:rgb(249, 242, 244);">1014KB</font>
+ <font style="color:rgb(199, 37, 78);background-color:rgb(249, 242, 244);">Mobile</font><font style="color:rgb(44, 62, 80);">侧因手机配置原因，除加载外渲染速度也是优化重点</font>
+ <font style="color:rgb(44, 62, 80);">基于第五点，要合理处理代码减少渲染损耗</font>
+ <font style="color:rgb(44, 62, 80);">基于第二、第五点，所有影响首屏加载和渲染的代码应在处理逻辑中后置</font>
+ <font style="color:rgb(44, 62, 80);">加载完成后用户交互使用时也需注意性能</font>

**<font style="color:rgb(44, 62, 80);">2. 加载优化</font>**

<font style="color:rgb(85, 85, 85);background-color:rgb(255, 249, 249);">加载过程是最为耗时的过程，可能会占到总耗时的</font><font style="color:rgb(199, 37, 78);background-color:rgb(249, 242, 244);">80%</font><font style="color:rgb(85, 85, 85);background-color:rgb(255, 249, 249);">时间，因此是优化的重点</font>

**<font style="color:rgb(44, 62, 80);">2.1 缓存</font>**

<font style="color:rgb(85, 85, 85);background-color:rgb(255, 249, 249);">使用缓存可以减少向服务器的请求数，节省加载时间，所以所有静态资源都要在服务器端设置缓存，并且尽量使用长</font><font style="color:rgb(199, 37, 78);background-color:rgb(249, 242, 244);">Cache</font><font style="color:rgb(85, 85, 85);background-color:rgb(255, 249, 249);">（长</font><font style="color:rgb(199, 37, 78);background-color:rgb(249, 242, 244);">Cache</font><font style="color:rgb(85, 85, 85);background-color:rgb(255, 249, 249);">资源的更新可使用时间戳）</font>

**<font style="color:rgb(44, 62, 80);">2.2 压缩HTML、CSS、JavaScript</font>**

<font style="color:rgb(85, 85, 85);background-color:rgb(255, 249, 249);">减少资源大小可以加快网页显示速度，所以要对</font><font style="color:rgb(199, 37, 78);background-color:rgb(249, 242, 244);">HTML</font><font style="color:rgb(85, 85, 85);background-color:rgb(255, 249, 249);">、</font><font style="color:rgb(199, 37, 78);background-color:rgb(249, 242, 244);">CSS</font><font style="color:rgb(85, 85, 85);background-color:rgb(255, 249, 249);">、</font><font style="color:rgb(199, 37, 78);background-color:rgb(249, 242, 244);">JavaScript</font><font style="color:rgb(85, 85, 85);background-color:rgb(255, 249, 249);">等进行代码压缩，并在服务器端设置</font><font style="color:rgb(199, 37, 78);background-color:rgb(249, 242, 244);">GZip</font>

+ <font style="color:rgb(44, 62, 80);">a） 压缩（例如，多余的空格、换行符和缩进）</font>
+ <font style="color:rgb(44, 62, 80);">b） 启用</font><font style="color:rgb(199, 37, 78);background-color:rgb(249, 242, 244);">GZip</font>

**<font style="color:rgb(44, 62, 80);">2.3 无阻塞</font>**

<font style="color:rgb(85, 85, 85);background-color:rgb(255, 249, 249);">写在</font><font style="color:rgb(199, 37, 78);background-color:rgb(249, 242, 244);">HTML</font><font style="color:rgb(85, 85, 85);background-color:rgb(255, 249, 249);">头部的</font><font style="color:rgb(199, 37, 78);background-color:rgb(249, 242, 244);">JavaScript</font><font style="color:rgb(85, 85, 85);background-color:rgb(255, 249, 249);">（无异步），和写在</font><font style="color:rgb(199, 37, 78);background-color:rgb(249, 242, 244);">HTML</font><font style="color:rgb(85, 85, 85);background-color:rgb(255, 249, 249);">标签中的</font><font style="color:rgb(199, 37, 78);background-color:rgb(249, 242, 244);">Style</font><font style="color:rgb(85, 85, 85);background-color:rgb(255, 249, 249);">会阻塞页面的渲染，因此</font><font style="color:rgb(199, 37, 78);background-color:rgb(249, 242, 244);">CSS</font><font style="color:rgb(85, 85, 85);background-color:rgb(255, 249, 249);">放在页面头部并使用</font><font style="color:rgb(199, 37, 78);background-color:rgb(249, 242, 244);">Link</font><font style="color:rgb(85, 85, 85);background-color:rgb(255, 249, 249);">方式引入，避免在</font><font style="color:rgb(199, 37, 78);background-color:rgb(249, 242, 244);">HTML</font><font style="color:rgb(85, 85, 85);background-color:rgb(255, 249, 249);">标签中写</font><font style="color:rgb(199, 37, 78);background-color:rgb(249, 242, 244);">Style</font><font style="color:rgb(85, 85, 85);background-color:rgb(255, 249, 249);">，</font><font style="color:rgb(199, 37, 78);background-color:rgb(249, 242, 244);">JavaScript</font><font style="color:rgb(85, 85, 85);background-color:rgb(255, 249, 249);">放在页面尾部或使用异步方式加载</font>

**<font style="color:rgb(44, 62, 80);">2.4 使用首屏加载</font>**

<font style="color:rgb(85, 85, 85);background-color:rgb(255, 249, 249);">首屏的快速显示，可以大大提升用户对页面速度的感知，因此应尽量针对首屏的快速显示做优化。</font>

**<font style="color:rgb(44, 62, 80);">2.5 按需加载</font>**

<font style="color:rgb(85, 85, 85);background-color:rgb(255, 249, 249);">将不影响首屏的资源和当前屏幕资源不用的资源放到用户需要时才加载，可以大大提升重要资源的显示速度和降低总体流量。</font>

**<font style="color:rgb(44, 62, 80);">PS：按需加载会导致大量重绘，影响渲染性能</font>**

+ <font style="color:rgb(44, 62, 80);">a）</font><font style="color:rgb(44, 62, 80);"> </font><font style="color:rgb(199, 37, 78);background-color:rgb(249, 242, 244);">LazyLoad</font>
+ <font style="color:rgb(44, 62, 80);">b） 滚屏加载</font>
+ <font style="color:rgb(44, 62, 80);">c） 通过</font><font style="color:rgb(199, 37, 78);background-color:rgb(249, 242, 244);">Media Query</font><font style="color:rgb(44, 62, 80);">加载</font>

**<font style="color:rgb(44, 62, 80);">2.6 预加载</font>**

<font style="color:rgb(85, 85, 85);background-color:rgb(255, 249, 249);">大型重资源页面（如游戏）可使用增加</font><font style="color:rgb(199, 37, 78);background-color:rgb(249, 242, 244);">Loading</font><font style="color:rgb(85, 85, 85);background-color:rgb(255, 249, 249);">的方法，资源加载完成后再显示页面。但</font><font style="color:rgb(199, 37, 78);background-color:rgb(249, 242, 244);">Loading</font><font style="color:rgb(85, 85, 85);background-color:rgb(255, 249, 249);">时间过长，会造成用户流失。</font>

<font style="color:rgb(44, 62, 80);">对用户行为分析，可以在当前页加载下一页资源，提升速度。</font>

+ <font style="color:rgb(44, 62, 80);">a）可感知</font><font style="color:rgb(199, 37, 78);background-color:rgb(249, 242, 244);">Loading</font>
+ <font style="color:rgb(44, 62, 80);">b）不可感知的</font><font style="color:rgb(199, 37, 78);background-color:rgb(249, 242, 244);">Loading</font><font style="color:rgb(44, 62, 80);">（如提前加载下一页）</font>

**<font style="color:rgb(44, 62, 80);">2.7 压缩图片</font>**

<font style="color:rgb(85, 85, 85);background-color:rgb(255, 249, 249);">图片是最占流量的资源，因此尽量避免使用他，使用时选择最合适的格式（实现需求的前提下，以大小判断），合适的大小，然后使用智图压缩，同时在代码中用</font><font style="color:rgb(199, 37, 78);background-color:rgb(249, 242, 244);">Srcset</font><font style="color:rgb(85, 85, 85);background-color:rgb(255, 249, 249);">来按需显示</font>

**<font style="color:rgb(44, 62, 80);">PS：过度压缩图片大小影响图片显示效果</font>**

+ <font style="color:rgb(44, 62, 80);">a）使用智图（ http://zhitu.tencent.com/ ）</font>
+ <font style="color:rgb(44, 62, 80);">b）使用其它方式代替图片(1. 使用</font><font style="color:rgb(199, 37, 78);background-color:rgb(249, 242, 244);">CSS3</font><font style="color:rgb(44, 62, 80);"> </font><font style="color:rgb(44, 62, 80);">2. 使用</font><font style="color:rgb(199, 37, 78);background-color:rgb(249, 242, 244);">SVG</font><font style="color:rgb(44, 62, 80);"> </font><font style="color:rgb(44, 62, 80);">3. 使用</font><font style="color:rgb(199, 37, 78);background-color:rgb(249, 242, 244);">IconFont</font><font style="color:rgb(44, 62, 80);">）</font>
+ <font style="color:rgb(44, 62, 80);">c）使用</font><font style="color:rgb(199, 37, 78);background-color:rgb(249, 242, 244);">Srcset</font>
+ <font style="color:rgb(44, 62, 80);">d）选择合适的图片(1.</font><font style="color:rgb(44, 62, 80);"> </font><font style="color:rgb(199, 37, 78);background-color:rgb(249, 242, 244);">webP</font><font style="color:rgb(44, 62, 80);">优于</font><font style="color:rgb(199, 37, 78);background-color:rgb(249, 242, 244);">JPG</font><font style="color:rgb(44, 62, 80);">2.</font><font style="color:rgb(44, 62, 80);"> </font><font style="color:rgb(199, 37, 78);background-color:rgb(249, 242, 244);">PNG8</font><font style="color:rgb(44, 62, 80);">优于</font><font style="color:rgb(199, 37, 78);background-color:rgb(249, 242, 244);">GIF</font><font style="color:rgb(44, 62, 80);">）</font>
+ <font style="color:rgb(44, 62, 80);">e）选择合适的大小（1. 首次加载不大于</font><font style="color:rgb(199, 37, 78);background-color:rgb(249, 242, 244);">1014KB</font><font style="color:rgb(44, 62, 80);"> </font><font style="color:rgb(44, 62, 80);">2. 不宽于</font><font style="color:rgb(199, 37, 78);background-color:rgb(249, 242, 244);">640</font><font style="color:rgb(44, 62, 80);">（基于手机屏幕一般宽度））</font>

**<font style="color:rgb(44, 62, 80);">2.8 减少Cookie</font>**

<font style="color:rgb(199, 37, 78);background-color:rgb(249, 242, 244);">Cookie</font><font style="color:rgb(85, 85, 85);background-color:rgb(255, 249, 249);">会影响加载速度，所以静态资源域名不使用</font><font style="color:rgb(199, 37, 78);background-color:rgb(249, 242, 244);">Cookie</font><font style="color:rgb(85, 85, 85);background-color:rgb(255, 249, 249);">。</font>

**<font style="color:rgb(44, 62, 80);">2.9 避免重定向</font>**

<font style="color:rgb(44, 62, 80);">重定向会影响加载速度，所以在服务器正确设置避免重定向。</font>

**<font style="color:rgb(44, 62, 80);">2.10 异步加载第三方资源</font>**

<font style="color:rgb(44, 62, 80);">第三方资源不可控会影响页面的加载和显示，因此要异步加载第三方资源</font>

**<font style="color:rgb(44, 62, 80);">2.11 减少HTTP请求</font>**

<font style="color:rgb(85, 85, 85);background-color:rgb(255, 249, 249);">因为手机浏览器同时响应请求为4个请求（</font><font style="color:rgb(199, 37, 78);background-color:rgb(249, 242, 244);">Android</font><font style="color:rgb(85, 85, 85);background-color:rgb(255, 249, 249);">支持4个，</font><font style="color:rgb(199, 37, 78);background-color:rgb(249, 242, 244);">iOS</font><font style="color:rgb(85, 85, 85);background-color:rgb(255, 249, 249);"> </font><font style="color:rgb(85, 85, 85);background-color:rgb(255, 249, 249);">5后可支持6个），所以要尽量减少页面的请求数，首次加载同时请求数不能超过4个</font>

+ <font style="color:rgb(44, 62, 80);">a）合并</font><font style="color:rgb(199, 37, 78);background-color:rgb(249, 242, 244);">CSS</font><font style="color:rgb(44, 62, 80);">、</font><font style="color:rgb(199, 37, 78);background-color:rgb(249, 242, 244);">JavaScript</font>
+ <font style="color:rgb(44, 62, 80);">b）合并小图片，使用雪碧图</font>

**<font style="color:rgb(44, 62, 80);">3. 三、脚本执行优化</font>**

<font style="color:rgb(85, 85, 85);background-color:rgb(255, 249, 249);">脚本处理不当会阻塞页面加载、渲染，因此在使用时需当注意</font>

+ <font style="color:rgb(199, 37, 78);background-color:rgb(249, 242, 244);">CSS</font><font style="color:rgb(44, 62, 80);">写在头部，</font><font style="color:rgb(199, 37, 78);background-color:rgb(249, 242, 244);">JavaScript</font><font style="color:rgb(44, 62, 80);">写在尾部或异步</font>
+ <font style="color:rgb(44, 62, 80);">避免图片和</font><font style="color:rgb(199, 37, 78);background-color:rgb(249, 242, 244);">iFrame</font><font style="color:rgb(44, 62, 80);">等的空</font><font style="color:rgb(199, 37, 78);background-color:rgb(249, 242, 244);">Src</font><font style="color:rgb(44, 62, 80);">，空</font><font style="color:rgb(199, 37, 78);background-color:rgb(249, 242, 244);">Src</font><font style="color:rgb(44, 62, 80);">会重新加载当前页面，影响速度和效率。</font>
+ <font style="color:rgb(44, 62, 80);">尽量避免重设图片大小</font>
+ <font style="color:rgb(44, 62, 80);">重设图片大小是指在页面、</font><font style="color:rgb(199, 37, 78);background-color:rgb(249, 242, 244);">CSS</font><font style="color:rgb(44, 62, 80);">、J</font><font style="color:rgb(199, 37, 78);background-color:rgb(249, 242, 244);">avaScript</font><font style="color:rgb(44, 62, 80);">等中多次重置图片大小，多次重设图片大小会引发图片的多次重绘，影响性能</font>
+ <font style="color:rgb(44, 62, 80);">图片尽量避免使用</font><font style="color:rgb(199, 37, 78);background-color:rgb(249, 242, 244);">DataURL</font><font style="color:rgb(44, 62, 80);">，</font><font style="color:rgb(199, 37, 78);background-color:rgb(249, 242, 244);">DataURL</font><font style="color:rgb(44, 62, 80);">图片没有使用图片的压缩算法文件会变大，并且要解码后再渲染，加载慢耗时长</font>

**<font style="color:rgb(44, 62, 80);">4. CSS优化</font>**

<font style="color:rgb(85, 85, 85);background-color:rgb(255, 249, 249);">尽量避免写在HTML标签中写</font><font style="color:rgb(199, 37, 78);background-color:rgb(249, 242, 244);">Style</font><font style="color:rgb(85, 85, 85);background-color:rgb(255, 249, 249);">属性</font>

**<font style="color:rgb(44, 62, 80);">4.1 css3过渡动画开启硬件加速</font>**

```css
.translate3d{
  -webkit-transform: translate3d(0, 0, 0);
  -moz-transform: translate3d(0, 0, 0);
  -ms-transform: translate3d(0, 0, 0);
  transform: translate3d(0, 0, 0);
}
```

**<font style="color:rgb(44, 62, 80);">4.2 避免CSS表达式</font>**

<font style="color:rgb(44, 62, 80);">CSS表达式的执行需跳出CSS树的渲染，因此请避免CSS表达式。</font>

**<font style="color:rgb(44, 62, 80);">4.3 不滥用Float</font>**

<font style="color:rgb(44, 62, 80);">Float在渲染时计算量比较大，尽量减少使用</font>

**<font style="color:rgb(44, 62, 80);">4.4 值为0时不需要任何单位</font>**

<font style="color:rgb(44, 62, 80);">为了浏览器的兼容性和性能，值为</font><font style="color:rgb(199, 37, 78);background-color:rgb(249, 242, 244);">0</font><font style="color:rgb(44, 62, 80);">时不要带单位</font>

**<font style="color:rgb(44, 62, 80);">5. JavaScript执行优化</font>**

**<font style="color:rgb(44, 62, 80);">5.1 减少重绘和回流</font>**

+ <font style="color:rgb(44, 62, 80);">避免不必要的Dom操作</font>
+ <font style="color:rgb(44, 62, 80);">尽量改变</font><font style="color:rgb(199, 37, 78);background-color:rgb(249, 242, 244);">Class</font><font style="color:rgb(44, 62, 80);">而不是</font><font style="color:rgb(199, 37, 78);background-color:rgb(249, 242, 244);">Style</font><font style="color:rgb(44, 62, 80);">，使用</font><font style="color:rgb(199, 37, 78);background-color:rgb(249, 242, 244);">classList</font><font style="color:rgb(44, 62, 80);">代替</font><font style="color:rgb(199, 37, 78);background-color:rgb(249, 242, 244);">className</font>
+ <font style="color:rgb(44, 62, 80);">避免使用</font><font style="color:rgb(199, 37, 78);background-color:rgb(249, 242, 244);">document.write</font>
+ <font style="color:rgb(44, 62, 80);">减少</font><font style="color:rgb(199, 37, 78);background-color:rgb(249, 242, 244);">drawImage</font>

**<font style="color:rgb(44, 62, 80);">5.2 TOUCH事件优化</font>**

<font style="color:rgb(85, 85, 85);background-color:rgb(255, 249, 249);">使用</font><font style="color:rgb(199, 37, 78);background-color:rgb(249, 242, 244);">touchstart</font><font style="color:rgb(85, 85, 85);background-color:rgb(255, 249, 249);">、</font><font style="color:rgb(199, 37, 78);background-color:rgb(249, 242, 244);">touchend</font><font style="color:rgb(85, 85, 85);background-color:rgb(255, 249, 249);">代替</font><font style="color:rgb(199, 37, 78);background-color:rgb(249, 242, 244);">click</font><font style="color:rgb(85, 85, 85);background-color:rgb(255, 249, 249);">，因快影响速度快。但应注意</font><font style="color:rgb(199, 37, 78);background-color:rgb(249, 242, 244);">Touch</font><font style="color:rgb(85, 85, 85);background-color:rgb(255, 249, 249);">响应过快，易引发误操作</font>

**<font style="color:rgb(44, 62, 80);">6. 渲染优化</font>**

**<font style="color:rgb(44, 62, 80);">6.1 HTML使用Viewport</font>**

**<font style="color:rgb(44, 62, 80);">Viewport可以加速页面的渲染，请使用以下代码</font>**

```html
<meta name=”viewport” content=”width=device-width, initial-scale=1″>
```

**<font style="color:rgb(44, 62, 80);">6.2 动画优化</font>**

+ <font style="color:rgb(44, 62, 80);">尽量使用</font><font style="color:rgb(199, 37, 78);background-color:rgb(249, 242, 244);">CSS3</font><font style="color:rgb(44, 62, 80);">动画</font>
+ <font style="color:rgb(44, 62, 80);">合理使用</font><font style="color:rgb(199, 37, 78);background-color:rgb(249, 242, 244);">requestAnimationFrame</font><font style="color:rgb(44, 62, 80);">动画代替</font><font style="color:rgb(199, 37, 78);background-color:rgb(249, 242, 244);">setTimeout</font>
+ <font style="color:rgb(44, 62, 80);">适当使用</font><font style="color:rgb(199, 37, 78);background-color:rgb(249, 242, 244);">Canvas</font><font style="color:rgb(44, 62, 80);">动画</font><font style="color:rgb(44, 62, 80);"> </font><font style="color:rgb(199, 37, 78);background-color:rgb(249, 242, 244);">5</font><font style="color:rgb(44, 62, 80);">个元素以内使用</font><font style="color:rgb(199, 37, 78);background-color:rgb(249, 242, 244);">css</font><font style="color:rgb(44, 62, 80);">动画，</font><font style="color:rgb(199, 37, 78);background-color:rgb(249, 242, 244);">5</font><font style="color:rgb(44, 62, 80);">个以上使用</font><font style="color:rgb(199, 37, 78);background-color:rgb(249, 242, 244);">Canvas</font><font style="color:rgb(44, 62, 80);">动画（</font><font style="color:rgb(199, 37, 78);background-color:rgb(249, 242, 244);">iOS8</font><font style="color:rgb(44, 62, 80);">可使用</font><font style="color:rgb(199, 37, 78);background-color:rgb(249, 242, 244);">webGL</font><font style="color:rgb(44, 62, 80);">）</font>

**<font style="color:rgb(44, 62, 80);">6.3 高频事件优化</font>**

<font style="color:rgb(199, 37, 78);background-color:rgb(249, 242, 244);">Touchmove</font><font style="color:rgb(85, 85, 85);background-color:rgb(255, 249, 249);">、</font><font style="color:rgb(199, 37, 78);background-color:rgb(249, 242, 244);">Scroll</font><font style="color:rgb(85, 85, 85);background-color:rgb(255, 249, 249);"> </font><font style="color:rgb(85, 85, 85);background-color:rgb(255, 249, 249);">事件可导致多次渲染</font>

+ <font style="color:rgb(44, 62, 80);">使用</font><font style="color:rgb(199, 37, 78);background-color:rgb(249, 242, 244);">requestAnimationFrame</font><font style="color:rgb(44, 62, 80);">监听帧变化，使得在正确的时间进行渲染</font>
+ <font style="color:rgb(44, 62, 80);">增加响应变化的时间间隔，减少重绘次数</font>

**<font style="color:rgb(44, 62, 80);">6.4 GPU加速</font>**

<font style="color:rgb(199, 37, 78);background-color:rgb(249, 242, 244);">CSS</font><font style="color:rgb(85, 85, 85);background-color:rgb(255, 249, 249);">中以下属性（</font><font style="color:rgb(199, 37, 78);background-color:rgb(249, 242, 244);">CSS3 transitions</font><font style="color:rgb(85, 85, 85);background-color:rgb(255, 249, 249);">、</font><font style="color:rgb(199, 37, 78);background-color:rgb(249, 242, 244);">CSS3 3D transforms</font><font style="color:rgb(85, 85, 85);background-color:rgb(255, 249, 249);">、</font><font style="color:rgb(199, 37, 78);background-color:rgb(249, 242, 244);">Opacity</font><font style="color:rgb(85, 85, 85);background-color:rgb(255, 249, 249);">、</font><font style="color:rgb(199, 37, 78);background-color:rgb(249, 242, 244);">Canvas</font><font style="color:rgb(85, 85, 85);background-color:rgb(255, 249, 249);">、</font><font style="color:rgb(199, 37, 78);background-color:rgb(249, 242, 244);">WebGL</font><font style="color:rgb(85, 85, 85);background-color:rgb(255, 249, 249);">、</font><font style="color:rgb(199, 37, 78);background-color:rgb(249, 242, 244);">Video</font><font style="color:rgb(85, 85, 85);background-color:rgb(255, 249, 249);">）来触发</font><font style="color:rgb(199, 37, 78);background-color:rgb(249, 242, 244);">GPU</font><font style="color:rgb(85, 85, 85);background-color:rgb(255, 249, 249);">渲染，请合理使用</font>

